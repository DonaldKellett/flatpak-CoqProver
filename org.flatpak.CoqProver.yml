app-id: org.flatpak.CoqProver
runtime: org.freedesktop.Platform
runtime-version: '20.08'
sdk: org.freedesktop.Sdk
command: run.sh
modules:
  - name: ocaml
    buildsystem: simple
    build-commands:
      - ./configure -prefix /app -cc "gcc -fcommon"
      - make world.opt
      - make install
      - make clean
    sources:
      - type: archive
        url: https://github.com/ocaml/ocaml/archive/4.07.0.tar.gz
        sha256: 8dd39da81beaad53a158e71c428f902b609d8f7f33fedf37f15c56be6c4cf840
  - name: findlib
    buildsystem: simple
    build-commands:
      - ./configure
      - make all
      - make opt
      - make install
      - make clean
      - ocamlfind list
    sources:
      - type: archive
        url: https://github.com/ocaml/ocamlfind/archive/findlib-1.8.0.tar.gz
        sha256: c8655fcd53ad8462f37c4080af90f04984f09797a714fd2cb4128bc7428eaba2
  - name: zarith
    ensure-writable:
      - /lib/ocaml/ld.conf
    buildsystem: simple
    build-commands:
      - ./configure
      - make
      - make tests
      - make install
      - ocamlfind list
    sources:
      - type: archive
        url: https://github.com/ocaml/Zarith/archive/release-1.10.tar.gz
        sha256: 0b7eb0a6c65a5401eef9c15e5ea6794b8aef36b0a3c718187c3ccd2a36a0b9e3
  - name: coq
    buildsystem: simple
    build-commands:
      - ./configure -prefix /app
      - make
      - make install
    sources:
      - type: archive
        url: https://github.com/coq/coq/archive/V8.13.0.tar.gz
        sha256: 06445dbd6cb3c8a2e4e957dbd12e094d609a62fcb0c8c3cad0cd1fdedda25c9b
  - name: run
    buildsystem: simple
    build-commands:
      - install -D run.sh /app/bin/run.sh
    sources:
      - type: file
        path: run.sh
